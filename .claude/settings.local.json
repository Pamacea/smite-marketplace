{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "mcp__zai-mcp-server__ui_to_artifact",
      "mcp__zread__search_doc",
      "mcp__zread__read_file",
      "mcp__zread__get_repo_structure",
      "WebSearch",
      "mcp__web-search-prime__webSearchPrime",
      "mcp__web-reader__webReader",
      "Bash(del:*)",
      "Bash(npm install:*)",
      "Bash(npm run build:*)",
      "Bash(/plugin install:*)",
      "Bash(/plugin install smite-architect@smite-marketplace)",
      "Bash(/plugin install smite-handover@smite-marketplace)",
      "Bash(/plugin:*)",
      "Bash(bash:*)",
      "Bash(ls:*)",
      "Bash(git config:*)",
      "Skill(smite-orchestrator:smite:orchestrator)",
      "Bash(find:*)",
      "Bash(findstr:*)",
      "Bash(npm run typecheck:*)",
      "Bash(while read dir)",
      "Bash(do if [ -f \"C:\\\\Users\\\\Yanis\\\\Projects\\\\smite-marketplace\\\\plugins$dir\\\\agents$dir.task.md\" ])",
      "Bash(then echo \"‚úÖ $dir\")",
      "Bash(else echo \"‚ùå $dir \\(missing\\)\")",
      "Bash(fi:*)",
      "Bash(done:*)",
      "Bash(if exist \"plugins\\\\nul\" del \"plugins\\\\nul\")",
      "Bash(tree:*)",
      "Bash(wc:*)",
      "Bash(xargs:*)",
      "Skill(smite-explorer:smite:explorer)",
      "Skill(smite-brainstorm:smite:brainstorm)",
      "Bash(cat:*)",
      "Skill(smite-explorer:explorer)",
      "Skill(linter-sentinel:linter-sentinel)",
      "Skill(doc-maintainer:doc-maintainer)",
      "Bash(python:*)",
      "Bash(npx tsc:*)",
      "Bash(npx prettier:*)",
      "Bash(npx eslint:*)",
      "Bash(grep:*)",
      "Skill(smite-gatekeeper:smite:gatekeeper)",
      "Skill(smite-handover:smite:handover)",
      "Skill(smite-surgeon:smite:surgeon)",
      "Bash(node:*)",
      "Bash(if:*)",
      "Bash(then echo \"Directory exists\")",
      "Bash(else:*)",
      "Bash(then echo \"‚úÖ detect-debt.js exists\")",
      "Bash(then echo \"‚úÖ agent-complete.js exists\")",
      "Bash(echo:*)",
      "Bash(then ls -lh plugins/smite-orchestrator/dist/*.js)"
    ]
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "A file was just modified. Check if:\n1. The file path contains 'docs/' directory\n2. The file extension is .md\n\nIf BOTH conditions are true:\n1. Inform the user: 'üìÑ Documentation modified: {filePath}'\n2. Suggest: 'Should I run Gatekeeper to validate this documentation?'\n3. If user agrees, use: Skill tool with skill='smite-gatekeeper:smite:gatekeeper' and args='--artifact={filePath}'\n\nDo NOT trigger for:\n- node_modules/\n- dist/\n- .git/\n- Files matching *.test.md or *.spec.md"
          }
        ]
      },
      {
        "matcher": "Edit|Write.*\\.(ts|tsx|js|jsx)$",
        "hooks": [
          {
            "type": "command",
            "command": "node plugins/smite-orchestrator/dist/detect-debt.js file $FILE_PATH",
            "statusMessage": "üî™ Detecting technical debt..."
          },
          {
            "type": "prompt",
            "prompt": "A source file was just modified. The detect-debt script ran. If technical debt was found in the output:\n1. Inform the user: 'üî™ Technical debt detected in {filePath}'\n2. List each issue with line number and severity from the script output\n3. Suggest: 'Run Surgeon to address {N} technical debt items?'\n4. If user agrees, use: Skill tool with skill='smite-surgeon:smite:surgeon' and args='--target={filePath} --auto-detect'\n\nOnly scan these extensions: .ts, .tsx, .js, .jsx\nIgnore: test files, node_modules/, dist/"
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "smite-",
        "hooks": [
          {
            "type": "command",
            "command": "node plugins/smite-orchestrator/dist/agent-complete.js $AGENT_NAME",
            "statusMessage": "üéØ Updating workflow state..."
          },
          {
            "type": "prompt",
            "prompt": "A smite agent just completed and the state was updated. Read .smite/orchestrator-state.json to understand workflow state. Then:\n1. Identify which agent just completed\n2. Determine the next logical agent based on:\n   - Standard workflow: initializer ‚Üí explorer ‚Üí strategist ‚Üí aura ‚Üí constructor ‚Üí gatekeeper ‚Üí handover\n   - OR custom workflow if defined in orchestrator state\n3. Inform user: '‚úÖ {agentName} completed'\n4. Suggest: 'üîÑ Next agent: {nextAgent} - {reason}'\n5. Ask: 'Run {nextAgent}? [Y]es / [N]o / [S]kip'\n\nCheck .smite/suggestions/next-action.md for the generated suggestion file."
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Task.*smite-|Skill.*smite-",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "CRITICAL: Before invoking any smite agent, use smite-router FIRST to ensure optimal agent selection.\n\nStep 1: Analyze if the user's request matches a specific agent need:\n- Does the user explicitly mention an agent name? ‚Üí Use that agent directly\n- Does the user mention a specific task (impl√©menter, refactor, explorer)? ‚Üí Use smite-router first\n- Is the context unclear? ‚Üí Use smite-router\n\nStep 2: If smite-router is needed:\n1. Use Skill tool with skill='smite-router:router' FIRST\n2. Let smite-router analyze the project (package.json, tsconfig.json, Cargo.toml, etc.)\n3. Get smite-router's recommendation for the best agent with correct flags\n4. THEN invoke the recommended agent with those parameters\n\nExample:\n- User: 'Cr√©er une page profile'\n- I use: Skill(smite-router:router) ‚Üí Detects Next.js ‚Üí Suggests 'smite-constructor --tech=nextjs'\n- I then use: Task('smite-constructor:constructor.task', prompt='Cr√©er une page profile en mode Next.js')\n\nStep 3: Only if workflow order validation is needed:\n1. Read .smite/orchestrator-state.json\n2. Check which agents have already been called\n3. Validate workflow order: initializer ‚Üí explorer ‚Üí strategist ‚Üí aura ‚Üí constructor ‚Üí gatekeeper ‚Üí handover\n4. If workflow order is violated, warn the user\n\nIMPORTANT: Always use smite-router FIRST when the agent choice is ambiguous or context-dependent."
          }
        ]
      },
      {
        "matcher": "",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "GENERAL AGENT SELECTION GUIDELINE:\n\nWhen choosing which agent to use, follow this decision tree:\n\n1. Is the user's task about IMPLEMENTATION/CODING?\n   ‚Üí Use smite-router FIRST to detect tech stack\n   ‚Üí Route to: smite-constructor with correct --tech flag\n\n2. Is the task about CODEBASE ANALYSIS?\n   ‚Üí Use: smite-explorer\n\n3. Is the task about REFACTORING?\n   ‚Üí Use: smite-surgeon\n\n4. Is the task about QUALITY/TESTS?\n   ‚Üí Use: smite-gatekeeper\n\n5. Is the task about DOCUMENTATION?\n   ‚Üí Use: smite-handover\n\n6. Is the task about BUSINESS STRATEGY?\n   ‚Üí Use: smite-strategist\n\n7. Is the task about CREATIVE THINKING?\n   ‚Üí Use: smite-brainstorm\n\nIf unsure, ALWAYS use smite-router to analyze the context first."
          }
        ]
      }
    ]
  }
}

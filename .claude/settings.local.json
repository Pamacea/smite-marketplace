{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "mcp__zai-mcp-server__ui_to_artifact",
      "mcp__zread__search_doc",
      "mcp__zread__read_file",
      "mcp__zread__get_repo_structure",
      "WebSearch",
      "mcp__web-search-prime__webSearchPrime",
      "mcp__web-reader__webReader",
      "Bash(del:*)",
      "Bash(npm install:*)",
      "Bash(npm run build:*)",
      "Bash(/plugin install:*)",
      "Bash(/plugin:*)",
      "Bash(bash:*)",
      "Bash(ls:*)",
      "Bash(git config:*)",
      "Skill(smite-orchestrator:smite:orchestrator)",
      "Bash(find:*)",
      "Bash(findstr:*)",
      "Bash(npm run typecheck:*)",
      "Bash(tree:*)",
      "Bash(wc:*)",
      "Bash(xargs:*)",
      "Skill(smite-explorer:smite:explorer)",
      "Skill(smite-brainstorm:smite:brainstorm)",
      "Bash(cat:*)",
      "Skill(smite-explorer:explorer)",
      "Skill(linter-sentinel:linter-sentinel)",
      "Skill(doc-maintainer:doc-maintainer)",
      "Bash(python:*)",
      "Bash(npx tsc:*)",
      "Bash(npx prettier:*)",
      "Bash(npx eslint:*)",
      "Bash(grep:*)",
      "Skill(smite-gatekeeper:smite:gatekeeper)",
      "Skill(smite-handover:smite:handover)",
      "Skill(smite-surgeon:smite:surgeon)",
      "Bash(echo:*)",
      "Bash(done:*)",
      "Bash(git remote get-url:*)",
      "Skill(ralph:ralph)",
      "Bash(node:*)",
      "Bash(head:*)",
      "Skill(builder:smite-builder)",
      "Bash(bun install)",
      "Bash(bun run build)",
      "Bash(npx tsx:*)",
      "Bash(git reset:*)",
      "Bash(git branch:*)",
      "Bash(git rm:*)",
      "Skill(statusline:statusline)",
      "Bash(bun:*)",
      "Bash(timeout:*)",
      "Skill(commit)",
      "Bash(for:*)",
      "Bash(if [ -f \"$dirREADME.md\" ])",
      "Bash(then echo \"HAS README\")",
      "Bash(else echo \"MISSING README\")",
      "Bash(fi)"
    ]
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "A file was just modified. Check if:\n1. The file path contains 'docs/' directory\n2. The file extension is .md\n\nIf BOTH conditions are true:\n1. Inform the user: 'üìÑ Documentation modified: {filePath}'\n2. Suggest: 'Should I run Gatekeeper to validate this documentation?'\n3. If user agrees, use: Skill tool with skill='smite-gatekeeper:smite:gatekeeper' and args='--artifact={filePath}'\n\nDo NOT trigger for:\n- node_modules/\n- dist/\n- .git/\n- Files matching *.test.md or *.spec.md"
          }
        ]
      },
      {
        "matcher": "Edit|Write.*\\.(ts|tsx|js|jsx)$",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "You are a technical debt detector. A TypeScript/JavaScript file was just edited/written.\n\nStep 1: Check file eligibility\n- ONLY scan files matching: **.ts, .tsx, .js, .jsx**\n- IGNORE if file path contains: test, spec, node_modules, dist, build\n- Get the file path from the tool result context\n\nStep 2: Read the file and scan for:\n\n1. **'any' types** (HIGH severity)\n   - Search for: ': any', '<any>', 'any[]'\n   - Example: 'function foo(x: any)'\n\n2. **TODO/FIXME comments** (MEDIUM severity)\n   - Search for: '// TODO:', '// FIXME:', '// TODO ', '// FIXME '\n\n3. **console.log/debugger** (MEDIUM severity)\n   - Search for: 'console.log', 'console.debug', 'debugger'\n   - Exclude: console.error, console.warn (these are legitimate)\n\n4. **Long functions** (LOW severity)\n   - Identify functions/methods > 50 lines\n   - Exclude: test files, component definitions (React)\n\n5. **Empty interfaces/types** (HIGH severity)\n   - Search for: 'interface {}', 'type {}', 'interface Empty'\n\n6. **@ts-ignore/@ts-nocheck** (HIGH severity)\n   - Search for: '@ts-ignore', '@ts-nocheck'\n\n7. **Missing return types** (LOW severity, if strict mode)\n   - Functions without explicit return types\n   - Exclude: arrow functions, React components\n\nStep 3: Report findings\n\nIf ANY issues are found, format output as:\n```\nüî™ Technical Debt Detected in {filePath}\n\nSeverity: [HIGH/MEDIUM/LOW]\nIssues:\n1. Line {line}: 'any' type found in '{functionName}' - HIGH\n2. Line {line}: console.log left in production code - MEDIUM\n3. Line {line}: Empty interface '{interfaceName}' - HIGH\n...\n\nTotal: {N} issue(s)\n\nRecommendation: Run smite-surgeon for automatic refactoring?\n[Y]es - Launch surgeon agent\n[N]o - Keep debt for now\n[S]kip - Don't ask again for this file\n```\n\nIf NO issues found:\n- No output (silent success)\n\nExecute this check IMMEDIATELY after every Edit/Write operation on TS/JS files."
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "smite-",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "You are a SMITE Orchestrator workflow manager. A smite agent just completed.\n\nStep 1: Identify the completed agent\n- Get the agent name from the context (e.g., 'smite-explorer', 'smite-constructor')\n- Extract the base name (remove 'smite-' prefix if present)\n\nStep 2: Load or create orchestrator state\n- Try to read: `.smite/orchestrator-state.json`\n- If file doesn't exist, create initial state:\n```json\n{\n  \"session_id\": \"<generate-uuid>\",\n  \"created_at\": \"<ISO-timestamp>\",\n  \"updated_at\": \"<ISO-timestamp>\",\n  \"project_dir\": \"<current-directory>\",\n  \"current_agent\": null,\n  \"phase\": \"init\",\n  \"artifacts\": [],\n  \"agents_called\": [],\n  \"workflow_complete\": false,\n  \"last_completed_agent\": \"<completed-agent-name>\"\n}\n```\n\nStep 3: Update state\n- Set `current_agent` to null (agent completed)\n- Set `last_completed_agent` to the completed agent name\n- Add agent to `agents_called` array if not already present\n- Update `updated_at` timestamp\n- Write updated state back to `.smite/orchestrator-state.json`\n\nStep 4: Determine next agent\n- Use standard workflow order:\n  1. initializer\n  2. explorer\n  3. strategist\n  4. aura\n  5. constructor\n  6. gatekeeper\n  7. handover\n- Find the position of `last_completed_agent` in this order\n- Suggest the next agent in sequence\n- If all agents completed, set `workflow_complete: true` and suggest no next agent\n\nStep 5: Generate workflow progress\n- Create a visual progress bar showing completed agents\n- Use emojis: ‚úÖ for completed, ‚è≥ for current, ‚ùå for pending\n- Example:\n```\n‚úÖ initializer ‚Üí ‚úÖ explorer ‚Üí ‚è≥ strategist ‚Üí ‚ùå aura ‚Üí ‚ùå constructor ‚Üí ‚ùå gatekeeper ‚Üí ‚ùå handover\n```\n\nStep 6: Create suggestion file\n- Ensure directory `.smite/suggestions/` exists\n- Create file: `.smite/suggestions/next-action.md`\n- Content format:\n```markdown\n# üéØ NEXT AGENT SUGGESTION\n\n**Generated**: <ISO-timestamp>\n**Completed**: <completed-agent>\n\n---\n\n## ‚úÖ Completed: <AGENT-NAME>\n\nAgent has finished its work.\n\n---\n\n## üéØ Recommendation\n\n**Next Agent**: `<next-agent-name>` (or 'Workflow Complete!')\n\n**Reason**: <why this agent is next>\n\n---\n\n## üìä Workflow Progress\n\n<visual-progress-bar-from-Step-5>\n\n---\n\n## üöÄ Quick Start\n\nTo continue the workflow, run:\n\n```\n/smite:<next-agent>\n```\n\n(Or: 'üéâ All agents completed! Review the artifacts in the `docs/` directory.')\n\n---\n\n## üìã Deliverables\n\n<list-of-deliverables-or-'No deliverables yet'>\n\n---\n\n*Suggestions are automatically generated by SMITE Orchestrator*\n```\n\nStep 7: Inform user\n- Display: `‚úÖ <agent-name> completed`\n- Display: `üîÑ Next agent: <next-agent> - <reason>`\n- Ask: `Run <next-agent>? [Y]es / [N]o / [S]kip`\n\nExecute these steps IMMEDIATELY after any smite agent completes."
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Task.*smite-|Skill.*smite-",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "CRITICAL: Before invoking any smite agent, use smite-router FIRST to ensure optimal agent selection.\n\nStep 1: Analyze if the user's request matches a specific agent need:\n- Does the user explicitly mention an agent name? ‚Üí Use that agent directly\n- Does the user mention a specific task (impl√©menter, refactor, explorer)? ‚Üí Use smite-router first\n- Is the context unclear? ‚Üí Use smite-router\n\nStep 2: If smite-router is needed:\n1. Use Skill tool with skill='smite-router:router' FIRST\n2. Let smite-router analyze the project (package.json, tsconfig.json, Cargo.toml, etc.)\n3. Get smite-router's recommendation for the best agent with correct flags\n4. THEN invoke the recommended agent with those parameters\n\nExample:\n- User: 'Cr√©er une page profile'\n- I use: Skill(smite-router:router) ‚Üí Detects Next.js ‚Üí Suggests 'smite-constructor --tech=nextjs'\n- I then use: Task('smite-constructor:constructor.task', prompt='Cr√©er une page profile en mode Next.js')\n\nStep 3: Only if workflow order validation is needed:\n1. Read .smite/orchestrator-state.json\n2. Check which agents have already been called\n3. Validate workflow order: initializer ‚Üí explorer ‚Üí strategist ‚Üí aura ‚Üí constructor ‚Üí gatekeeper ‚Üí handover\n4. If workflow order is violated, warn the user\n\nIMPORTANT: Always use smite-router FIRST when the agent choice is ambiguous or context-dependent."
          }
        ]
      },
      {
        "matcher": "",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "GENERAL AGENT SELECTION GUIDELINE:\n\nWhen choosing which agent to use, follow this decision tree:\n\n1. Is the user's task about IMPLEMENTATION/CODING?\n   ‚Üí Use smite-router FIRST to detect tech stack\n   ‚Üí Route to: smite-constructor with correct --tech flag\n\n2. Is the task about CODEBASE ANALYSIS?\n   ‚Üí Use: smite-explorer\n\n3. Is the task about REFACTORING?\n   ‚Üí Use: smite-surgeon\n\n4. Is the task about QUALITY/TESTS?\n   ‚Üí Use: smite-gatekeeper\n\n5. Is the task about DOCUMENTATION?\n   ‚Üí Use: smite-handover\n\n6. Is the task about BUSINESS STRATEGY?\n   ‚Üí Use: smite-strategist\n\n7. Is the task about CREATIVE THINKING?\n   ‚Üí Use: smite-brainstorm\n\nIf unsure, ALWAYS use smite-router to analyze the context first."
          }
        ]
      }
    ]
  }
}

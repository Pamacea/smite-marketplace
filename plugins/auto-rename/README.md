# Auto Rename Session

Automatically rename your Claude Code sessions with intelligent, context-aware names generated by AI.

## Features

- **Automatic Renaming**: Sessions are renamed automatically based on their content
- **Intelligent Analysis**: Uses LLM to understand session context and generate descriptive names
- **Dynamic Updates**: Session names update as your session evolves
- **Manual Override**: Use `/rename` command for custom names
- **Smart Triggers**: Renames at optimal moments (session start, after significant actions)
- **Format Consistency**: All names follow "Action: Context" pattern
- **Slash Command Filtering**: Automatically removes commands like `/debug`, `/commit` from session names

## Installation

1. Copy the plugin to your Claude plugins directory:
```bash
cp -r plugins/auto-rename-session ~/.claude/plugins/
```

2. Restart Claude Code

## How It Works

### Automatic Triggers

The plugin automatically renames your session at these moments:

1. **Session Start**: Analyzes the first user message and sets initial name
2. **After Significant Tools**: Post writing files, running git commands, or package management
3. **After User Prompts**: Periodically updates based on conversation evolution

### Name Generation

The plugin analyzes:
- Your first request in the session (with slash commands filtered out)
- Recent tools and commands used
- Project context
- Conversation patterns

**Slash Command Filtering**: Commands like `/debug`, `/commit`, `/smite:debug` are automatically removed from the content before analysis, so your session names focus on the actual work being done.

Then generates a concise name following this format:
```
Action: Context
```

Examples:
- `Fix: authentication bug`
- `Add: user CRUD API`
- `Refactor: database schema`
- `Debug: memory leak`
- `Docs: API README`

## Usage

### Automatic Mode

Just work normally! The plugin runs automatically in the background.

```bash
# Start working
> I need to fix a bug in the login flow

# Plugin automatically renames session
[AutoRename] Session renamed to: "Fix: login bug"
```

### Manual Mode

Use the `/rename` command for custom names:

```bash
# Auto-generate a new name
/rename

# Set a custom name
/rename Working on OAuth2 integration
```

## Configuration

Edit `config/settings.json` to customize behavior:

```json
{
  "maxSessionNameLength": 50,
  "maxRenamesPerSession": 10,
  "renameTriggers": {
    "sessionStart": true,
    "postToolUse": true,
    "userPromptSubmit": true
  }
}
```

### Settings

| Setting | Description | Default |
|---------|-------------|---------|
| `maxSessionNameLength` | Maximum characters for session names | 50 |
| `maxRenamesPerSession` | Maximum automatic renames per session | 10 |
| `renameTriggers.sessionStart` | Rename when session starts | true |
| `renameTriggers.postToolUse` | Rename after tool usage | true |
| `renameTriggers.userPromptSubmit` | Rename after user prompts | true |

## Name Formats

### Action Prefixes

| Prefix | Usage | Example |
|--------|-------|---------|
| **Fix** | Bug fixes, error resolution | `Fix: login bug` |
| **Add** | New features, functionality | `Add: API endpoint` |
| **Update** | Modifying existing features | `Update: user model` |
| **Delete** | Removing code, features | `Delete: deprecated code` |
| **Refactor** | Code restructuring | `Refactor: database` |
| **Debug** | Investigation, debugging | `Debug: crash issue` |
| **Test** | Writing tests | `Test: auth flow` |
| **Docs** | Documentation | `Docs: README` |
| **Config** | Configuration changes | `Config: env vars` |

## Examples

### Example 1: Bug Fix Session

```bash
# User starts session
> I'm getting a 500 error when users try to login

# Plugin renames automatically
[AutoRename] Session renamed to: "Debug: login error"

# After investigation and fix
[AutoRename] Session renamed to: "Fix: login 500 error"
```

### Example 2: Feature Development

```bash
# User starts session
> I need to add a new API endpoint for user management

# Plugin renames automatically
[AutoRename] Session renamed to: "Add: user management API"
```

### Example 3: Refactoring

```bash
# User starts session
> The database schema needs to be optimized

# Plugin renames automatically
[AutoRename] Session renamed to: "Refactor: database schema"
```

## How Session Names Are Stored

Session names are stored as system messages in your `.jsonl` session files:

```jsonl
{"type": "system", "message": {"role": "system", "content": "Session renamed to: \"Fix: login bug\""}, "timestamp": "2025-01-19T10:30:00Z"}
```

This makes session names visible when you:
- View session history
- Resume previous sessions
- Search through sessions

## Troubleshooting

### Session Names Include Commands (e.g., "Debug: /debug fix...")

The plugin automatically filters out slash commands, but if you still see them:
1. Make sure you're using the latest version
2. Commands are filtered before LLM analysis
3. The name should reflect the task, not the command

Example:
```
Input:  "/debug fix the auto rename system"
Output: "Fix: auto rename system"  ✓ Not "Debug: /debug fix..."
```

### Plugin Not Working

1. Check plugin is installed:
```bash
ls ~/.claude/plugins/auto-rename-session
```

2. Check Node.js is available:
```bash
node --version
```

3. Check for errors in Claude Code output

### Session Not Renaming

1. Verify session has enough content (at least 2-3 messages)
2. Check `maxRenamesPerSession` limit in config
3. Try manual rename: `/rename`

### Name Not Generated

The plugin falls back to generic names like "Working on code" if:
- Session content is insufficient
- LLM generation fails
- Network issues

## Architecture

```
auto-rename-session/
├── .claude-plugin/
│   └── plugin.json          # Plugin metadata and hooks
├── hooks/
│   ├── hooks.json           # Hook configuration
│   ├── rename-script.js     # Main rename logic
│   └── session-manager.js   # Session file operations
├── commands/
│   └── rename.md            # /rename command
├── config/
│   └── settings.json        # Plugin configuration
└── README.md
```

### Components

- **rename-script.js**: Main entry point, handles hook events
- **session-manager.js**: Manages session file reading/writing
- **hooks.json**: Defines when renames occur
- **plugin.json**: Plugin metadata and hook registration

## Contributing

Contributions welcome! Areas for improvement:
- Better name generation prompts
- Additional trigger strategies
- Multi-language support
- Custom name templates

## License

MIT License - Feel free to use and modify

## Credits

Built for SMITE plugin ecosystem
